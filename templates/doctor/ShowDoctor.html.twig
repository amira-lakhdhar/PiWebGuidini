{% extends 'base.html.twig' %}

{% block title %}Hello EvenementController!{% endblock %}

{% block body %}
<div class="col-sm-8" style="text-align: center; margin-left: 150px">

        <img src="{{ asset('Uploads/Image/'~doctor.Image) }}" style="width:70%; border-color: #0a0c0d; border: 10px; border-radius: 5px 5px 0 0;">

        <div class="container" >
            <h4><b>{{ doctor.name }}</b></h4>
            <p>{{ doctor.location }}<br>
                <b>Speciality : </b> {{ doctor.speciality }}<br>
                <b>Phone Number : </b> {{ doctor.phone }}<br>
                <b>Place of Work : </b> {{ doctor.getIdHospital().name }}<br>
            <div class="row">
                    <div class="stars">
                        {% if ratings==1 %}
                            <i class="las la-star" data-value="1"></i>
                            <i class="lar la-star" data-value="2"></i>
                            <i class="lar la-star" data-value="3"></i>
                            <i class="lar la-star" data-value="4"></i>
                            <i class="lar la-star" data-value="5"></i>
                        {% elseif ratings==2 %}
                            <i class="las la-star" data-value="1"></i>
                            <i class="las la-star" data-value="2"></i>
                            <i class="lar la-star" data-value="3"></i>
                            <i class="lar la-star" data-value="4"></i>
                            <i class="lar la-star" data-value="5"></i>
                        {% elseif ratings==3 %}
                            <i class="las la-star" data-value="1"></i>
                            <i class="las la-star" data-value="2"></i>
                            <i class="las la-star" data-value="3"></i>
                            <i class="lar la-star" data-value="4"></i>
                            <i class="lar la-star" data-value="5"></i>
                        {% elseif ratings==4 %}
                            <i class="las la-star" data-value="1"></i>
                            <i class="las la-star" data-value="2"></i>
                            <i class="las la-star" data-value="3"></i>
                            <i class="las la-star" data-value="4"></i>
                            <i class="lar la-star" data-value="5"></i>
                        {% else %}
                            <i class="las la-star" data-value="1"></i>
                            <i class="las la-star" data-value="2"></i>
                            <i class="las la-star" data-value="3"></i>
                            <i class="las la-star" data-value="4"></i>
                            <i class="las la-star" data-value="5"></i>
                        {% endif %}
                    </div>

            </div>

            {{ form_start(form1) }}
            <div class="my-custom-class-for-errors">
                {{ form_errors(form1) }}
            </div>
            <div class="row">
                <div class="col"  hidden>
                    {{ form_widget(form1.rate) }}
                </div>

            </div>

            <button class="btn">{{ button_label|default('Save Rate') }}</button>
            <a class="btn btn-primary" href="{{ path('DisplayDoctorUser') }}">Back to Doctors List</a>

            {{ form_end(form1) }}

        </div>
    </div>


    <br>
    {% block javascripts %}
    <script>

        window.onload = () => {
            // On va chercher toutes les étoiles
            const stars = document.querySelectorAll(".la-star");

            // On va chercher l'input
            const note = document.querySelector("#rate_doctor_rate");

            // On boucle sur les étoiles pour le ajouter des écouteurs d'évènements
            for(star of stars){
                // On écoute le survol
                star.addEventListener("mouseover", function(){
                    resetStars();
                    this.style.color = "red";
                    this.classList.add("las");
                    this.classList.remove("lar");
                    // L'élément précédent dans le DOM (de même niveau, balise soeur)
                    let previousStar = this.previousElementSibling;

                    while(previousStar){
                        // On passe l'étoile qui précède en rouge
                        previousStar.style.color = "red";
                        previousStar.classList.add("las");
                        previousStar.classList.remove("lar");
                        // On récupère l'étoile qui la précède
                        previousStar = previousStar.previousElementSibling;
                    }
                });

                // On écoute le clic
                star.addEventListener("click", function(){
                    note.value = this.dataset.value;
                });

                star.addEventListener("mouseout", function(){
                    resetStars(note.value);
                });
            }

            /**
             * Reset des étoiles en vérifiant la note dans l'input caché
             * @param {number} note
             */
            function resetStars(note = 0){
                for(star of stars){
                    if(star.dataset.value > note){
                        star.style.color = "black";
                        star.classList.add("lar");
                        star.classList.remove("las");
                    }else{
                        star.style.color = "red";
                        star.classList.add("las");
                        star.classList.remove("lar");
                    }
                }
            }
        }
    </script>

    {% endblock %}

{% endblock %}